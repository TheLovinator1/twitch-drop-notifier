{% extends "base.html" %}
{% block content %}
    <div class="container mt-4">
        {% for game in games %}
            <div class="card mb-4">
                <div class="row g-0">
                    <div class="col-md-2">
                        <img src="{{ game.image_url }}"
                             alt="{{ game.display_name }}"
                             class="img-fluid rounded-start"
                             height="150"
                             width="150"
                             loading="lazy">
                    </div>
                    <div class="col-md-4">
                        <div class="card-body">
                            <h2 class="card-title h5">
                                <a href="{{ game.twitch_url }}" class="text-decoration-none">{{ game.display_name }}</a>
                            </h2>
                        </div>
                    </div>
                </div>
                {% for campaign in game.campaigns %}
                    <div class="card-body card-bottom">
                        <h3 class="h6">{{ campaign.name }}</h3>
                        <p class="mb-2 text-muted">Ends in: {{ campaign.end_at|timeuntil }}</p>
                        {% if campaign.description != campaign.name %}
                            {% if campaign.description|length|get_digit:"-1" > 100 %}
                                <p>
                                    <a class="btn btn-link p-0 text-muted"
                                       data-bs-toggle="collapse"
                                       href="#collapseDescription{{ campaign.drop_id }}"
                                       role="button"
                                       aria-expanded="false"
                                       aria-controls="collapseDescription{{ campaign.drop_id }}">Show Description</a>
                                </p>
                                <div class="collapse" id="collapseDescription{{ campaign.drop_id }}">
                                    <div class="card card-body">{{ campaign.description }}</div>
                                    <br>
                                </div>
                            {% else %}
                                <p>{{ campaign.description }}</p>
                            {% endif %}
                        {% endif %}
                        {% for drop in campaign.drops %}
                            <div class="col-6 col-md-4 d-flex align-items-center mb-2 position-relative">
                                <img src="{{ drop.image_url }}"
                                     alt="{{ drop.name }} drop image"
                                     class="img-fluid rounded me-3"
                                     height="50"
                                     width="50"
                                     loading="lazy">
                                {{ drop.name }}
                            </div>
                        {% endfor %}
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
{% endblock content %}
